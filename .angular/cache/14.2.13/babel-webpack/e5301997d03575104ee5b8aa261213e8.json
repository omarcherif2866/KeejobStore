{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Voiture } from 'src/app/components/models/voiture';\nlet VoitureComponent = class VoitureComponent {\n  constructor(voitureService, messageService) {\n    this.voitureService = voitureService;\n    this.messageService = messageService;\n    this.displayModal = false; // Contrôle la visibilité du modal\n\n    this.voitureDialog = false;\n    this.actionLabel = 'Enregistrer';\n    this.deleteVoitureDialog = false;\n    this.voitures = [];\n    this.selectedVoitures = [];\n    this.submitted = false;\n    this.cols = [];\n    this.rowsPerPageOptions = [5, 10, 20];\n  }\n\n  ngOnInit() {\n    this.voiture = new Voiture('', 0, '', '', 0, '');\n    this.getAllVoitures();\n  }\n\n  openNew() {\n    this.voiture = new Voiture('', 0, '', '', 0, '');\n    this.submitted = false;\n    this.voitureDialog = true;\n    this.actionLabel = 'Enregistrer';\n  }\n\n  editVoiture(voiture) {\n    const voitureInstance = new Voiture(voiture._id, voiture.puissance_fiscale, voiture.marque, voiture.modele, voiture.nbr_portes, voiture.num_chas);\n\n    if (voitureInstance && voitureInstance.Id) {\n      this.voitureDialog = true;\n      this.voiture = voitureInstance;\n    }\n\n    this.actionLabel = 'Modifier';\n  }\n\n  deleteVoiture(voiture) {\n    const voitureInstance = new Voiture(voiture._id, voiture.puissance_fiscale, voiture.marque, voiture.modele, voiture.nbr_portes, voiture.num_chas);\n\n    if (voitureInstance && voitureInstance.Id) {\n      this.deleteVoitureDialog = true;\n      this.voiture = voitureInstance;\n    } else {\n      console.error('voiture object is missing ID:', voitureInstance);\n    }\n  }\n\n  confirmDelete() {\n    if (this.voiture && this.voiture.Id) {\n      this.voitureService.deleteVoiture(this.voiture.Id).subscribe(response => {\n        this.voitures = this.voitures.filter(val => val.Id !== this.voiture.Id);\n        this.messageService.add({\n          severity: 'success',\n          summary: 'Successful',\n          detail: 'Voiture supprimé',\n          life: 3000\n        });\n        this.voiture = new Voiture('', 0, '', '', 0, '');\n        this.deleteVoitureDialog = false;\n      }, error => {\n        console.error('Erreur lors de la suppression du voiture:', error);\n        this.messageService.add({\n          severity: 'error',\n          summary: 'Erreur',\n          detail: 'Échec de la suppression du voiture',\n          life: 3000\n        });\n        this.deleteVoitureDialog = false;\n      });\n    } else {\n      console.error('ID de voiture invalide:', this.voiture);\n      this.messageService.add({\n        severity: 'error',\n        summary: 'Erreur',\n        detail: 'ID de voiture invalide',\n        life: 3000\n      });\n      this.deleteVoitureDialog = false;\n    }\n  }\n\n  hideDialog() {\n    this.voitureDialog = false;\n    this.submitted = false;\n  }\n\n  saveVoiture() {\n    // Créer un objet voiture à envoyer en JSON\n    const voitureData = {\n      puissance_fiscale: this.voiture.PuissanceFiscale,\n      marque: this.voiture.Marque,\n      modele: this.voiture.Modele,\n      nbr_portes: this.voiture.NbrPortes,\n      num_chas: this.voiture.NumChas\n    }; // Vérifiez les données dans la console pour vous assurer qu'elles sont bien formatées\n\n    console.log(voitureData);\n\n    if (this.voiture.Id) {\n      // Mise à jour du voiture existant\n      this.voitureService.putVoiture(this.voiture.Id, voitureData).subscribe(res => {\n        this.voitureDialog = false;\n        this.messageService.add({\n          severity: 'success',\n          summary: 'Succès',\n          detail: 'Voiture mis à jour',\n          life: 3000\n        });\n        this.getAllVoitures();\n      }, error => {\n        console.error('Erreur lors de la mise à jour du voiture:', error);\n        this.messageService.add({\n          severity: 'error',\n          summary: 'Erreur lors de la mise à jour du voiture',\n          detail: error.message\n        });\n      });\n    } else {\n      // Ajouter un nouveau voiture\n      this.voitureService.addVoiture(voitureData).subscribe(res => {\n        this.voitureDialog = false;\n        this.voiture = new Voiture('', 0, '', '', 0, '');\n        this.messageService.add({\n          severity: 'success',\n          summary: 'Succès',\n          detail: 'Voiture ajouté',\n          life: 3000\n        });\n        this.getAllVoitures();\n      }, error => {\n        console.error('Erreur lors de l\\'ajout du voiture:', error);\n        this.messageService.add({\n          severity: 'error',\n          summary: 'Erreur lors de l\\'ajout du voiture',\n          detail: error.message\n        });\n      });\n    }\n  }\n\n  getAllVoitures() {\n    this.voitureService.getVoiture().subscribe(voitures => {\n      this.voitures = voitures;\n    }, error => {\n      console.error('Erreur lors de la récupération des voitures:', error);\n    });\n  }\n\n  onGlobalFilter(table, event) {\n    table.filterGlobal(event.target.value, 'contains');\n  }\n\n};\nVoitureComponent = __decorate([Component({\n  selector: 'app-voiture',\n  templateUrl: './voiture.component.html',\n  styleUrl: './voiture.component.scss'\n})], VoitureComponent);\nexport { VoitureComponent };","map":null,"metadata":{},"sourceType":"module"}