{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, Input, Output, EventEmitter } from '@angular/core';\nlet LogicielComponent = class LogicielComponent {\n  constructor(logicielService) {\n    this.logicielService = logicielService;\n    this.logicielSelected = new EventEmitter();\n    this.loading = false;\n    this.logiciels = [];\n    this.selectedLogiciels = []; // üîπ pour multi-s√©lection\n\n    this.newLogicielName = '';\n    this.selectedImage = null;\n    this.modalMode = 'add';\n    this.formData = {\n      id: null,\n      name: '',\n      image: ''\n    };\n    this.showModal = false;\n  }\n\n  ngOnInit() {\n    this.loadLogiciels();\n  }\n\n  handleAdd() {\n    this.modalMode = 'add';\n    this.formData = {\n      id: null,\n      name: '',\n      image: ''\n    };\n    this.selectedImage = null;\n    this.showModal = true;\n  }\n\n  closeModal() {\n    this.showModal = false;\n    this.formData = {\n      id: null,\n      name: '',\n      image: ''\n    };\n    this.selectedImage = null;\n  }\n\n  loadLogiciels() {\n    if (!this.sousFormationId) return;\n    this.logicielService.getLogiciel().subscribe(res => {\n      this.logiciels = res;\n    });\n  }\n\n  onFileSelected(event) {\n    const file = event.target.files[0];\n    if (file) this.selectedImage = file;\n  }\n\n  addLogiciel() {\n    if (!this.newLogicielName) return alert(\"Nom du logiciel requis\");\n    const fd = new FormData();\n    fd.append('name', this.newLogicielName);\n    fd.append('sousFormationKeejobId', this.sousFormationId.toString());\n    if (this.selectedImage) fd.append('image', this.selectedImage, this.selectedImage.name);\n    this.logicielService.addLogiciel(fd).subscribe(res => {\n      this.logiciels.push(res);\n      this.toggleLogiciel(res); // s√©lectionner automatiquement le nouveau logiciel\n\n      this.newLogicielName = '';\n      this.selectedImage = null;\n    });\n  }\n\n  toggleLogiciel(log) {\n    if (this.isSelected(log)) {\n      this.selectedLogiciels = this.selectedLogiciels.filter(l => l.id !== log.id);\n    } else {\n      this.selectedLogiciels.push(log);\n    } // on envoie la liste mise √† jour au parent\n\n\n    this.logicielSelected.emit(this.selectedLogiciels);\n  }\n\n  isSelected(log) {\n    return this.selectedLogiciels.some(l => l.id === log.id);\n  }\n\n  editlogicielFromParent(sf) {\n    console.log('Edition SF:', sf);\n    this.modalMode = 'edit'; // Charger les donn√©es de base\n\n    this.formData = {\n      id: sf.id || sf.Id,\n      name: sf.title || sf.Name,\n      image: sf.image || sf.Image\n    };\n\n    if (this.formData.image) {\n      this.selectedImage = {\n        name: 'Image existante'\n      };\n    }\n\n    this.showModal = true;\n  }\n\n};\n\n__decorate([Input()], LogicielComponent.prototype, \"sousFormationId\", void 0);\n\n__decorate([Output()], LogicielComponent.prototype, \"logicielSelected\", void 0);\n\nLogicielComponent = __decorate([Component({\n  selector: 'app-logiciel',\n  templateUrl: './logiciel.component.html',\n  styleUrls: ['./logiciel.component.css']\n})], LogicielComponent);\nexport { LogicielComponent };","map":null,"metadata":{},"sourceType":"module"}