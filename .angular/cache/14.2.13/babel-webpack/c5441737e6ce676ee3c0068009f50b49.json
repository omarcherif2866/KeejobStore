{"ast":null,"code":"import { __decorate } from \"tslib\";\nexport class LogicielComponent {\n  constructor(logicielService) {\n    this.logicielService = logicielService;\n    this.logicielSelected = new EventEmitter();\n    this.loading = false;\n    this.logiciels = [];\n    this.selectedLogiciels = [];\n    this.newLogicielName = '';\n    this.selectedImage = null;\n    this.modalMode = 'add';\n    this.formData = {\n      id: null,\n      name: '',\n      image: ''\n    };\n    this.showModal = false;\n  }\n\n  ngOnInit() {\n    this.loadLogiciels();\n  }\n\n  handleAdd() {\n    this.modalMode = 'add';\n    this.formData = {\n      id: null,\n      name: '',\n      image: ''\n    };\n    this.selectedImage = null;\n    this.showModal = true;\n  }\n\n  closeModal() {\n    this.showModal = false;\n    this.formData = {\n      id: null,\n      name: '',\n      image: ''\n    };\n    this.selectedImage = null;\n  } // ✅ CORRECTION : Suppression de la condition qui bloquait le chargement\n\n\n  loadLogiciels() {\n    this.loading = true;\n    this.logicielService.getLogiciel().subscribe({\n      next: res => {\n        this.logiciels = res;\n        this.loading = false;\n        console.log('Logiciels chargés:', res); // Pour déboguer\n      },\n      error: err => {\n        console.error('Erreur chargement logiciels:', err);\n        this.loading = false;\n      }\n    });\n  }\n\n  onFileSelected(event) {\n    const file = event.target.files[0];\n    if (file) this.selectedImage = file;\n  }\n\n  addLogiciel() {\n    if (!this.newLogicielName) return alert(\"Nom du logiciel requis\"); // ✅ Vérification : sousFormationId requis pour l'ajout\n\n    if (!this.sousFormationId) {\n      return alert(\"ID de sous-formation manquant\");\n    }\n\n    const fd = new FormData();\n    fd.append('name', this.newLogicielName);\n    fd.append('sousFormationKeejobId', this.sousFormationId.toString());\n    if (this.selectedImage) fd.append('image', this.selectedImage, this.selectedImage.name);\n    this.logicielService.addLogiciel(fd).subscribe(res => {\n      this.logiciels.push(res);\n      this.toggleLogiciel(res);\n      this.newLogicielName = '';\n      this.selectedImage = null;\n    });\n  }\n\n  toggleLogiciel(log) {\n    if (this.isSelected(log)) {\n      this.selectedLogiciels = this.selectedLogiciels.filter(l => l.id !== log.id);\n    } else {\n      this.selectedLogiciels.push(log);\n    }\n\n    this.logicielSelected.emit(this.selectedLogiciels);\n  }\n\n  isSelected(log) {\n    return this.selectedLogiciels.some(l => l.id === log.id);\n  }\n\n  editlogicielFromParent(sf) {\n    console.log('Edition SF:', sf);\n    this.modalMode = 'edit';\n    this.formData = {\n      id: sf.id || sf.Id,\n      name: sf.title || sf.Name,\n      image: sf.image || sf.Image\n    };\n\n    if (this.formData.image) {\n      this.selectedImage = {\n        name: 'Image existante'\n      };\n    }\n\n    this.showModal = true;\n  }\n\n}\n\n__decorate([Input()], LogicielComponent.prototype, \"sousFormationId\", void 0);\n\n__decorate([Output()], LogicielComponent.prototype, \"logicielSelected\", void 0);","map":null,"metadata":{},"sourceType":"module"}