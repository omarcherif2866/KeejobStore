{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Evaluation } from 'src/app/models/evaluation';\nimport Swal from 'sweetalert2';\nlet EvaluationDetailsComponent = class EvaluationDetailsComponent {\n  constructor(evaluationservice) {\n    this.evaluationservice = evaluationservice;\n    this.evaluations = [];\n    this.loading = false;\n    this.availableCategories = []; // Toutes les catégories disponibles\n\n    this.groupedDetails = {};\n  }\n\n  ngOnInit() {\n    this.fetchEvaluations();\n    this.fetchCategories();\n  }\n\n  fetchEvaluations() {\n    this.loading = true;\n    this.evaluationservice.getEvaluation().subscribe({\n      next: response => {\n        this.evaluations = response.map(data => new Evaluation(data));\n        this.loading = false;\n        console.log('Données reçues: ', this.evaluations); // Grouper les détails après avoir récupéré les évaluations\n\n        this.groupDetailsByCategory();\n      },\n      error: error => {\n        console.error('Erreur lors du chargement des évaluations:', error);\n        this.loading = false;\n        Swal.fire({\n          icon: 'error',\n          title: 'Erreur lors du chargement des données',\n          showConfirmButton: false,\n          timer: 1500\n        });\n      }\n    });\n  }\n\n  sanitizeImage(url) {\n    if (!url) return '';\n\n    if (url.includes(\"https://res.cloudinary.com\") && url.split(\"https://res.cloudinary.com\").length > 2) {\n      const parts = url.split(\"https://res.cloudinary.com/daxkymr4t/image/upload/\");\n      return \"https://res.cloudinary.com/daxkymr4t/image/upload/\" + parts[parts.length - 1];\n    }\n\n    return url;\n  }\n\n  fetchCategories() {\n    this.evaluationservice.getAllCategories().subscribe({\n      next: categories => {\n        this.availableCategories = categories;\n        console.log('Catégories disponibles:', this.availableCategories);\n      },\n      error: error => {\n        console.error('Erreur lors du chargement des catégories:', error);\n      }\n    });\n  }\n\n  groupDetailsByCategory() {\n    // Réinitialiser l'objet groupedDetails\n    this.groupedDetails = {}; // Parcourir toutes les évaluations\n\n    this.evaluations.forEach(evaluation => {\n      // Parcourir toutes les sections\n      evaluation.Sections.forEach(section => {\n        // Parcourir tous les détails\n        section.details.forEach(detail => {\n          // Ignorer les détails sans catégorie ou avec catégorie vide\n          if (!detail.category || detail.category.trim() === '') {\n            return; // Passer au détail suivant\n          }\n\n          const category = detail.category; // Si la catégorie n'existe pas encore, l'initialiser\n\n          if (!this.groupedDetails[category]) {\n            this.groupedDetails[category] = [];\n          } // Ajouter le détail à la catégorie\n\n\n          this.groupedDetails[category].push(detail);\n        });\n      });\n    });\n    console.log('Details groupés par catégorie:', this.groupedDetails);\n  } // Méthode utilitaire pour obtenir les détails d'une catégorie spécifique\n\n\n  getDetailsByCategory(category) {\n    return this.groupedDetails[category] || [];\n  } // Méthode utilitaire pour obtenir toutes les catégories avec des détails\n\n\n  getCategoriesWithDetails() {\n    return Object.keys(this.groupedDetails);\n  }\n\n};\nEvaluationDetailsComponent = __decorate([Component({\n  selector: 'app-evaluation-details',\n  templateUrl: './evaluation-details.component.html',\n  styleUrls: ['./evaluation-details.component.css']\n})], EvaluationDetailsComponent);\nexport { EvaluationDetailsComponent };","map":null,"metadata":{},"sourceType":"module"}